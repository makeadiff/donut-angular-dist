"use strict";angular.module("donutApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","ngStorage"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl",restricted:!0}).when("/add-donation",{templateUrl:"views/add-donation.html",controller:"AddDonationCtrl",restricted:!0}).when("/view-donation",{templateUrl:"views/view-donation.html",controller:"ViewDonationCtrl",restricted:!0}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",restricted:!1}).when("/logout",{templateUrl:"views/logout.html",controller:"LogoutCtrl",restricted:!1}).when("/select-event",{templateUrl:"views/select-event.html",controller:"SelectEventCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("donutApp").controller("HomeCtrl",["$scope",function(){}]),angular.module("donutApp").controller("AddDonationCtrl",["$http","$mdDialog","UserService","$location",function(a,b,c,d){var e=this;e.donation={},e.donation.name="",e.donation.amount="",e.donation.email="",e.donation.phone="",e.donation.address="",e.donation.eighty_g="false",e.phone_email_absent=!1,e.phone_invalid=!1,e.amount_invalid=!1,e.is_processing=!1,e.validCheck=function(){return 0==e.donationForm.$valid?!1:parseInt(e.donation.amount)>200&&""==e.donation.phone&&""==e.donation.email?(e.phone_email_absent=!0,!1):0==e.donation.phone.length||10==e.donation.phone.length&&!isNaN(e.donation.phone)?0!=e.donation.amount.length&&isNaN(e.donation.amount)?(e.amount_invalid=!0,e.phone_email_absent=!1,e.phone_invalid=!1,!1):(e.amount_invalid=!1,e.phone_invalid=!1,e.phone_email_absent=!1,!0):(e.phone_invalid=!0,!1)},e.addDonation=function(){if(e.is_processing=!0,c.checkLoggedIn()){var f=c.getUserId();a({method:"POST",url:"http://cfrapp.makeadiff.in:3000/donations/",withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"Origin, X-Requested-With, Content-Type, Accept",Authorization:"Basic "+window.btoa("mad:mad")},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},transformResponse:function(a){var b=new X2JS,c=b.xml_str2json(a);return c},data:{amount:e.donation.amount,first_name:e.donation.name,email_id:e.donation.email,phone_no:e.donation.phone,eighty_g_required:e.donation.eighty_g,address:e.donation.address,fundraiser_id:f,product_id:"GEN",donation_type:"GEN",format:"xml"}}).success(function(a){e.is_processing=!1;var c=b.alert().title("Success!").content("Donation successfully added. ID: "+a.donation.id.__text).ok("Ok");b.show(c)}).error(function(){e.is_processing=!1;var a=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(a)}),e.donation={},e.donation.name="",e.donation.amount="",e.donation.email="",e.donation.phone="",e.donation.address="",e.donation.eighty_g="false"}else{var g=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(g),d.path("/login")}}}]),angular.module("donutApp").controller("ViewDonationCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("donutApp").factory("UserService",["$localStorage",function(a){var b={};return b.setLoggedIn=function(b){a.user_id=b,a.loggedIn=!0},b.checkLoggedIn=function(){return a.loggedIn},b.getUserId=function(){return a.user_id},b.unsetLoggedIn=function(){a.user_id=0,a.loggedIn=!1},b}]),angular.module("donutApp").directive("checkUser",["$rootScope","$location","UserService",function(a,b,c){return{link:function(){a.$on("$routeChangeStart",function(a,d){d.restricted&&!c.checkLoggedIn()&&b.path("/login")})}}}]),angular.module("donutApp").controller("LoginCtrl",["$http","$scope","$mdToast","UserService","$location",function(a,b,c,d,e){var f=this;f.login={},f.login_invalid=!1,f.poc_not_assigned=!1,f.is_processing=!1,f.loginCheck=function(){f.is_processing=!0,a({method:"POST",url:"http://cfrapp.makeadiff.in:3000/mobileauth/",withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"Origin, X-Requested-With, Content-Type, Accept",Authorization:"Basic "+window.btoa("mad:mad")},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},transformResponse:function(a){var b=new X2JS,c=b.xml_str2json(a);return c},data:{phone_no:f.login.phone,password:f.login.password,format:"xml"}}).success(function(a){0==a.user.id?(f.is_processing=!1,d.unsetLoggedIn(),f.login_invalid=!0,f.poc_not_assigned=!1,f.login={}):-1==a.user.id?(f.is_processing=!1,d.unsetLoggedIn(),f.poc_not_assigned=!0,f.login_invalid=!1,f.login={}):(f.is_processing=!1,d.setLoggedIn(a.user.id),e.path("/"))}).error(function(){d.unsetLoggedIn()})}}]),angular.module("donutApp").controller("LogoutCtrl",["$location","UserService",function(a,b){b.unsetLoggedIn(),a.path("/login")}]),angular.module("donutApp").controller("SelectEventCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);