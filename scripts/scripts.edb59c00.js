"use strict";angular.module("donutApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","ngStorage"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",restricted:!0,title:"Home"}).when("/add-donation",{templateUrl:"views/add-donation.html",controller:"AddDonationCtrl",restricted:!0,title:"Add Donation"}).when("/view-donation",{templateUrl:"views/view-donation.html",controller:"ViewDonationCtrl",restricted:!0,title:"View Donation"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",restricted:!1,title:"Login"}).when("/logout",{templateUrl:"views/logout.html",controller:"LogoutCtrl",restricted:!1}).when("/select-event",{templateUrl:"views/select-event.html",controller:"SelectEventCtrl",restricted:!0}).when("/external-donation",{templateUrl:"views/external-donation.html",controller:"ExternalDonationCtrl",restricted:!0,title:"External Donations"}).when("/add-external-donation/:donation_type",{templateUrl:"views/add-external-donation.html",controller:"AddExternalDonationCtrl",restricted:!0,title:"Add External Donations"}).when("/add-nach-donation",{templateUrl:"views/add-nach-donation.html",controller:"AddNACHDonationCtrl",restricted:!0,title:"Add NACH Donation"}).when("/add-online-donation",{templateUrl:"views/add-online-donation.html",controller:"AddOnlineDonationCtrl",restricted:!0,title:"Add Online Donation"}).when("/approvals",{templateUrl:"views/approvals.html",restricted:!0,title:"Approve Donations"}).when("/approved-donations",{templateUrl:"views/approved-donations.html",restricted:!0,title:"Approved Donations"}).when("/fc-approvals",{templateUrl:"views/fc-approvals.html",restricted:!0,title:"Approve Donations"}).when("/fc-approved-donations",{templateUrl:"views/fc-approved-donations.html",restricted:!0,title:"Approved Donations"}).when("/change-password",{templateUrl:"views/change-password.html",controller:"ChangePasswordCtrl",restricted:!0,title:"Change Password"}).otherwise({redirectTo:"/"})}]).run(["$location","$rootScope","UserService",function(a,b,c){b.base_url="http://makeadiff.in/apps/exdon-beta/api/",b.user_name=c.getUserName(),b.transformRequest=function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},b.errorMessage=function(b,c){c||(c="Connection error. Please try again later.");var d=$mdDialog.alert().title("Error!").content(c).ok("Ok");return $mdDialog.show(d),b.match(/^\/.+/)||(b="/"),a.path(b),!1},b.$on("$routeChangeSuccess",function(a,c,d){c.$$route&&c.$$route.title?b.title=c.$$route.title:b.title="Donut"})}]).filter("dateToISO",function(){return function(a){var b=a.split(/[- :]/),c=new Date(b[0],b[1]-1,b[2],b[3],b[4],b[5]);return c.toISOString()}}).filter("statusFormat",function(){return function(a){a=a.replace(/[_\-]/g," ").replace(/([a-zA-Z])(\d)/g,"$1 $2").replace(/([a-z])([A-Z])/g,"$1 $2");var b=a.toLowerCase().split(" ").map(function(a){return a.replace(a[0],a[0].toUpperCase())}).join(" ");return b=b.replace("Poc","POC").replace("Fc","Finance Fellow")}}),angular.module("donutApp").controller("HomeCtrl",["UserService","$location",function(a,b){var c=this;a.checkLoggedIn()||b.path("/login"),c.is_poc=a.isPOC(),c.is_fc=a.isFC()}]),angular.module("donutApp").controller("AddDonationCtrl",["$http","$mdDialog","UserService","$location","$filter","$rootScope",function(a,b,c,d,e,f){var g=this;g.donation={};var h=d.search();null!=h.donor_name?g.donation.name=h.donor_name:g.donation.name="",null!=h.donor_phone?g.donation.phone=h.donor_phone:g.donation.phone="",null!=h.donor_email?g.donation.email=h.donor_email:g.donation.email="",null!=h.donor_city?g.donation.address=h.donor_city:g.donation.address="",null!=h.amount?g.donation.amount=h.amount:g.donation.amount="",g.donation.comment="",g.donation.eighty_g="false",g.phone_email_absent=!1,g.phone_invalid=!1,g.amount_invalid=!1,g.is_processing=!1;c.getUserId();g.validCheck=function(){return 0==g.donationForm.$valid?!1:parseInt(g.donation.amount)>200&&""==g.donation.phone&&""==g.donation.email?(g.phone_email_absent=!0,!1):0!=g.donation.phone.length&&isNaN(g.donation.phone)?(g.phone_invalid=!0,!1):0!=g.donation.amount.length&&isNaN(g.donation.amount)?(g.amount_invalid=!0,g.phone_email_absent=!1,g.phone_invalid=!1,!1):(g.amount_invalid=!1,g.phone_invalid=!1,g.phone_email_absent=!1,!0)},g.addDonation=function(){if(g.is_processing=!0,console.log(g),c.checkLoggedIn()){var h=c.getUserId();a({method:"POST",url:f.base_url+"donation/validate",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{amount:g.donation.amount,donor_name:g.donation.name,donor_email:g.donation.email,donor_phone:g.donation.phone,eighty_g_required:g.donation.eighty_g,address:g.donation.address,comment:g.donation.comment,fundraiser_id:h,created_at:e("date")(g.donation.created_at,"yyyy-MM-dd"),format:"json"}}).success(function(a){if(console.log(a),a.success)i();else{var c=b.confirm().title("Confirm").content(a.error).ok("Yes").cancel("No");b.show(c).then(function(){i()},function(){g.is_processing=!1})}}).error(function(a){g.is_processing=!1,g.is_error=!0;var c=b.alert().title("Error!").content("Connection issue with '"+f.base_url+"donation/add'. Please try again later.").ok("Ok");b.show(c)});var i=function(){a({method:"POST",url:f.base_url+"donation/add",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{amount:g.donation.amount,donor_name:g.donation.name,donor_email:g.donation.email,donor_phone:g.donation.phone,eighty_g_required:g.donation.eighty_g,address:g.donation.address,comment:g.donation.comment,fundraiser_id:h,created_at:e("date")(g.donation.created_at,"yyyy-MM-dd"),format:"json"}}).success(function(a){g.is_processing=!1,console.log(a);var c=b.alert().title("Success!").content("Donation successfully added. ID: "+a.donation.id).ok("Ok");b.show(c),g.donation={},g.donation.name="",g.donation.amount="",g.donation.email="",g.donation.phone="",g.donation.address="",g.donation.comment="",g.donation.eighty_g="false",g.donationForm.$setUntouched(),g.donationForm.$setPristine()}).error(function(a){g.is_processing=!1,g.is_error=!0;var c=b.alert().title("Error!").content("Connection issue with '"+f.base_url+"donation/add'. Please try again later.").ok("Ok");b.show(c)})}}else{g.is_processing=!1;var j=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(j),d.path("/login")}}}]),angular.module("donutApp").controller("ViewDonationCtrl",["$http","$mdDialog","UserService","$location",function(a,b,c,d){var e=this;if(e.is_processing=!0,e.donations={},c.checkLoggedIn()){var f=c.getUserId();a({method:"POST",url:"http://cfrapp.makeadiff.in:3000/mobile_reports/vol_report.json",withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"Origin, X-Requested-With, Content-Type, Accept",Authorization:"Basic "+window.btoa("mad:mad")},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{id:f}}).success(function(a){e.donations=a,e.is_processing=!1}).error(function(a){e.is_processing=!1;var c=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(c),d.path("/")})}else{e.is_processing=!1;var g=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(g),d.path("/login")}}]),angular.module("donutApp").factory("UserService",["$localStorage",function(a){var b={};return b.setLoggedIn=function(b){a.user_id=b.id,a.user=b,a.loggedIn=!0},b.checkLoggedIn=function(){return a.loggedIn},b.getUserId=function(){return a.user_id},b.getUserName=function(){return"undefined"==typeof a.user?!1:a.user.name},b.isPOC=function(){for(var b in a.user.roles)if(9==b)return!0;return!1},b.isFC=function(){for(var b in a.user.roles)if(8==b)return!0;return!1},b.unsetLoggedIn=function(){return a.user_id=0,a.user={},a.loggedIn=!1,!0},b}]),angular.module("donutApp").directive("checkUser",["$rootScope","$location","UserService",function(a,b,c){return{link:function(d,e,f,g){a.$on("$routeChangeStart",function(a,d,e){d.restricted&&!c.checkLoggedIn()&&b.path("/login")})}}}]),angular.module("donutApp").controller("LoginCtrl",["$http","$scope","$rootScope","$mdToast","UserService","$location",function(a,b,c,d,e,f){var g=this;g.login={},g.login_invalid=!1,g.error_message="",g.is_processing=!1,g.loginCheck=function(){g.is_processing=!0,a({method:"POST",url:c.base_url+"user/login",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{phone:g.login.phone,password:g.login.password,format:"xml"}}).success(function(a){a.error?(g.is_processing=!1,e.unsetLoggedIn(),g.login_invalid=!0,g.error_message=a.error,g.login={}):(g.is_processing=!1,e.setLoggedIn(a.user),f.path("/"))}).error(function(a){e.unsetLoggedIn()})}}]),angular.module("donutApp").controller("LogoutCtrl",["$location","UserService",function(a,b){b.unsetLoggedIn(),a.path("/login")}]),angular.module("donutApp").controller("ApprovalsCtrl",["$http","$scope","$rootScope","$mdDialog","UserService","$location","$cookies",function(a,b,c,d,e,f,g){var h=this;if(h.is_processing=!0,h.error="",h.donations={},h.active_donation_id=0,h.poc_or_fc="poc",e.checkLoggedIn()){var i=e.getUserId();e.isPOC()?h.poc_or_fc="poc":h.poc_or_fc="fc",a({method:"GET",url:c.base_url+"donation/get_donations_for_"+h.poc_or_fc+"_approval/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,a.success?h.donations=a.donations:h.error=a.error}).error(function(){return h.is_processing=!1,c.errorMessage()})}else h.errorMessage("/login","Connection error. Please login once again.");h.userCheck=function(){return e.checkLoggedIn()?!0:h.errorMessage("/login","Please login to use this feature.")},h.errorMessage=function(a,b){return h.is_processing=!1,c.errorMessage(a,b)},h.approveDonation=function(a){if(h.is_processing=!0,h.active_donation_id=a,!h.userCheck())return!1;e.getUserId();if(g.get("daily_confirmation"))return void h.approveDonationCall();var b=d.confirm().title("Collected?").content("Please ensure that you have collected Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name+". Press 'Yes' if already collected. Press 'No' if not collected yet.").ok("Yes").cancel("No");d.show(b).then(function(){var a=new Date;a.setDate(a.getDate()+1),g.put("daily_confirmation","1",{expires:a}),h.approveDonationCall()},function(){h.is_processing=!1})},h.approveDonationCall=function(){var b=h.active_donation_id;a({method:"GET",url:c.base_url+"donation/"+b+"/"+h.poc_or_fc+"_approve/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="APPROVED",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Approved. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)},h.deleteDonation=function(a){if(!h.userCheck())return!1;h.active_donation_id=a;var b=d.confirm().title("Delete Donation?").content("Are you sure you want to delete the donation of Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name).ok("Yes").cancel("No");d.show(b).then(h.deleteDonationCall)},h.deleteDonationCall=function(){h.is_processing=!0;var b=h.active_donation_id,f=e.getUserId();a({method:"GET",url:c.base_url+"donation/"+b+"/delete/"+f,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="DELETED",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Deleted. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)}}]),angular.module("donutApp").controller("ApprovedDonationsCtrl",["$http","$scope","$rootScope","$mdDialog","UserService","$location","$cookies",function(a,b,c,d,e,f,g){var h=this;if(h.is_processing=!0,h.error="",h.donations={},h.active_donation_id=0,h.poc_or_fc="poc",e.checkLoggedIn()){var i=e.getUserId();e.isPOC()?h.poc_or_fc="poc":h.poc_or_fc="fc",console.log(h.poc_or_fc),a({method:"GET",url:c.base_url+"donation/get_"+h.poc_or_fc+"_approved_donations/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,a.success?h.donations=a.donations:h.error=a.error}).error(function(a){return h.is_processing=!1,c.errorMessage()})}else h.errorMessage("/login","Connection error. Please login once again.");h.userCheck=function(){return e.checkLoggedIn()?!0:h.errorMessage("/login","Please login to use this feature.")},h.errorMessage=function(a,b){return h.is_processing=!1,c.errorMessage(a,b)},h.rejectDonation=function(a){if(!h.userCheck())return!1;h.active_donation_id=a;var b=d.confirm().title("Reject Donation?").content("Are you sure you want to reject the donation of Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name).ok("Yes").cancel("No");d.show(b).then(h.rejectDonationCall,function(){})},h.rejectDonationCall=function(){h.is_processing=!0;var b=h.active_donation_id,f=e.getUserId();a({method:"GET",url:c.base_url+"donation/"+b+"/"+h.poc_or_fc+"_reject/"+f,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="TO_BE_APPROVED_BY_POC",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Recjected. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)},h.deleteDonation=function(a){if(!h.userCheck())return!1;h.active_donation_id=a;var b=d.confirm().title("Delete Donation?").content("Are you sure you want to delete the donation of Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name).ok("Yes").cancel("No");d.show(b).then(h.deleteDonationCall)},h.deleteDonationCall=function(){h.is_processing=!0;var b=h.active_donation_id,f=e.getUserId();a({method:"GET",url:c.base_url+"donation/"+b+"/delete/"+f,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="DELETED",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Deleted. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)}}]),angular.module("donutApp").controller("FcApprovalsCtrl",["$http","$scope","$rootScope","$mdDialog","UserService","$location","$cookies",function(a,b,c,d,e,f,g){var h=this;if(h.is_processing=!0,h.error="",h.donations={},h.active_donation_id=0,e.checkLoggedIn()){var i=e.getUserId();a({method:"GET",url:c.base_url+"donation/get_donations_for_fc_approval/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,a.success?h.donations=a.donations:h.error=a.error}).error(function(){return h.is_processing=!1,c.errorMessage()})}else h.errorMessage("/login","Connection error. Please login once again.");h.userCheck=function(){return e.checkLoggedIn()?!0:h.errorMessage("/login","Please login to use this feature.")},h.errorMessage=function(a,b){return h.is_processing=!1,c.errorMessage(a,b)},h.approveDonation=function(a){if(h.is_processing=!0,h.active_donation_id=a,!h.userCheck())return!1;e.getUserId();if(g.get("daily_confirmation"))return void h.approveDonationCall();var b=d.confirm().title("Collected?").content("Please ensure that you have collected Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name+". Press 'Yes' if already collected. Press 'No' if not collected yet.").ok("Yes").cancel("No");d.show(b).then(function(){var a=new Date;a.setDate(a.getDate()+1),g.put("daily_confirmation","1",{expires:a}),h.approveDonationCall()},function(){h.is_processing=!1})},h.approveDonationCall=function(){var b=h.active_donation_id;a({method:"GET",url:c.base_url+"donation/"+b+"/fc_approve/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="APPROVED",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Approved. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)},h.deleteDonation=function(a){if(!h.userCheck())return!1;h.active_donation_id=a;var b=d.confirm().title("Delete Donation?").content("Are you sure you want to delete the donation of Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name).ok("Yes").cancel("No");d.show(b).then(h.deleteDonationCall)},h.deleteDonationCall=function(){h.is_processing=!0;var b=h.active_donation_id,f=e.getUserId();a({method:"GET",url:c.base_url+"donation/"+b+"/delete/"+f,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="DELETED",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Deleted. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)}}]),angular.module("donutApp").controller("FcApprovedDonationsCtrl",["$http","$scope","$rootScope","$mdDialog","UserService","$location","$cookies",function(a,b,c,d,e,f,g){var h=this;if(h.is_processing=!0,h.error="",h.donations={},h.active_donation_id=0,e.checkLoggedIn()){var i=e.getUserId();a({method:"GET",url:c.base_url+"donation/get_fc_approved_donations/"+i,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,a.success?h.donations=a.donations:h.error=a.error}).error(function(a){return h.is_processing=!1,c.errorMessage()})}else h.errorMessage("/login","Connection error. Please login once again.");h.userCheck=function(){return e.checkLoggedIn()?!0:h.errorMessage("/login","Please login to use this feature.")},h.errorMessage=function(a,b){return h.is_processing=!1,c.errorMessage(a,b)},h.rejectDonation=function(a){if(!h.userCheck())return!1;h.active_donation_id=a;var b=d.confirm().title("Reject Donation?").content("Are you sure you want to reject the donation of Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name).ok("Yes").cancel("No");d.show(b).then(h.rejectDonationCall,function(){})},h.rejectDonationCall=function(){h.is_processing=!0;var b=h.active_donation_id,f=e.getUserId();a({method:"GET",url:c.base_url+"donation/"+b+"/fc_reject/"+f,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="TO_BE_APPROVED_BY_POC",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Recjected. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)},h.deleteDonation=function(a){if(!h.userCheck())return!1;h.active_donation_id=a;var b=d.confirm().title("Delete Donation?").content("Are you sure you want to delete the donation of Rs. "+h.donations[a].amount+" from "+h.donations[a].user_name).ok("Yes").cancel("No");d.show(b).then(h.deleteDonationCall)},h.deleteDonationCall=function(){h.is_processing=!0;var b=h.active_donation_id,f=e.getUserId();a({method:"GET",url:c.base_url+"donation/"+b+"/delete/"+f,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:c.transformRequest}).success(function(a){h.is_processing=!1,h.donations[a.donation_id].donation_status="DELETED",h.active_donation_id=0;var b=d.alert().title("Success!").content("Donation Deleted. ID: "+a.donation_id).ok("Ok");d.show(b)}).error(h.errorMessage)}}]),angular.module("donutApp").controller("ChangePasswordCtrl",["$http","$mdDialog","UserService","$location",function(a,b,c,d){var e=this;e.password="",e.password_confirmation="",e.password_not_match=!1,e.password_length_less=!1,e.is_processing=!1,e.validCheck=function(){return""==e.password||""==e.password_confirmation?!1:""!=e.password&&""!=e.password_confirmation&&e.password==e.password_confirmation&&e.password.length<4?(e.password_not_match=!1,e.password_length_less=!0,!1):""!=e.password&&""!=e.password_confirmation&&e.password!=e.password_confirmation?(e.password_not_match=!0,e.password_length_less=!1,!1):(e.password_not_match=!1,e.password_length_less=!1,!0)},e.changePassword=function(){if(e.is_processing=!0,c.checkLoggedIn()){var f=c.getUserId();a({method:"PATCH",url:"http://cfrapp.makeadiff.in:3000/mobileauth/"+f,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded","Access-Control-Allow-Origin":"Origin, X-Requested-With, Content-Type, Accept",Authorization:"Basic "+window.btoa("mad:mad")},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},transformResponse:function(a){var b=new X2JS,c=b.xml_str2json(a);return c},data:{password:e.password_confirmation}}).success(function(a){e.is_processing=!1;var c=b.alert().title("Success!").content("Password succesfully changed").ok("Ok");b.show(c),d.path("/")}).error(function(a){e.is_processing=!1;var c=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(c)})}else{e.is_processing=!1;var g=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(g),d.path("/login")}e.password="",e.password_confirmation=""}}]),angular.module("donutApp").controller("ExternalDonationCtrl",["$location",function(a){}]),angular.module("donutApp").controller("AddNACHDonationCtrl",["$http","$mdDialog","UserService","$location","$routeParams","$filter","$rootScope",function(a,b,c,d,e,f,g){var h=this;h.donation={};var i=d.search();null!=i.donor_name?h.donation.name=i.donor_name:h.donation.name="",null!=i.donor_phone?h.donation.phone=i.donor_phone:h.donation.phone="",null!=i.donor_email?h.donation.email=i.donor_email:h.donation.email="",null!=i.donor_city?h.donation.address=i.donor_city:h.donation.address="",null!=i.amount?h.donation.amount=i.amount:h.donation.amount="",h.donation.donation_type="nach",h.donation.created_at=new Date,h.is_error=!1,h.phone_absent=!1,h.email_absent=!1,h.phone_invalid=!1,h.email_invalid=!1,h.amount_invalid=!1,h.is_processing=!1,h.fundraiser_id=c.getUserId(),h.validCheck=function(){return 0==h.donationForm.$valid?!1:""==h.donation.phone?(h.phone_absent=!0,!1):""==h.donation.email?(h.email_absent=!0,!1):10!=h.donation.phone.length||isNaN(h.donation.phone)?(h.phone_invalid=!0,!1):h.donation.email.match(/^[\w\-\+\.]+\@[\w\-\.]+\.[\w]{2,5}$/)?0!=h.donation.amount.length&&isNaN(h.donation.amount)?(h.amount_invalid=!0,!1):(h.phone_absent=!1,h.email_absent=!1,h.phone_invalid=!1,h.email_invalid=!1,h.amount_invalid=!1,!0):(h.email_invalid=!0,!1)},h.addExDonation=function(){if(h.is_processing=!0,c.checkLoggedIn()){var e=c.getUserId();a({method:"POST",url:g.base_url+"donation/add",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{amount:h.donation.amount,donor_name:h.donation.name,donor_email:h.donation.email,donor_phone:h.donation.phone,fundraiser_id:e,created_at:f("date")(h.donation.created_at,"yyyy-MM-dd"),donation_type:h.donation.donation_type,format:"json"}}).success(function(a){h.is_processing=!1;var c=b.alert().title("Success!").content("Donation successfully added. ID: "+a.donation.id).ok("Ok");b.show(c)}).error(function(a){h.is_processing=!1,h.is_error=!0;var c=b.alert().title("Error!").content("Connection issue with '"+add_donation_url+"'. Please try again later.").ok("Ok");b.show(c)})}else{h.is_processing=!1,h.is_error=!0;var i=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(i),d.path("/login")}h.donation={},h.donation.name="",h.donation.amount="",h.donation.email="",h.donation.phone="",h.donation.donation_type="",h.donation.created_at="",h.donationForm.$setUntouched(),h.donationForm.$setPristine()}}]),angular.module("donutApp").controller("AddOnlineDonationCtrl",["$http","$mdDialog","UserService","$location","$routeParams","$filter","$rootScope",function(a,b,c,d,e,f,g){var h=this;h.donation={};var i=d.search();null!=i.donor_name?h.donation.name=i.donor_name:h.donation.name="",null!=i.donor_phone?h.donation.phone=i.donor_phone:h.donation.phone="",null!=i.donor_email?h.donation.email=i.donor_email:h.donation.email="",null!=i.donor_city?h.donation.address=i.donor_city:h.donation.address="",null!=i.amount?h.donation.amount=i.amount:h.donation.amount="",h.donation.donation_type="mad_website",h.donation.created_at=new Date,h.is_error=!1,h.phone_absent=!1,h.email_absent=!1,h.phone_invalid=!1,h.email_invalid=!1,h.amount_invalid=!1,h.is_processing=!1,h.fundraiser_id=c.getUserId(),h.validCheck=function(){return 0==h.donationForm.$valid?!1:""==h.donation.phone?(h.phone_absent=!0,!1):""==h.donation.email?(h.email_absent=!0,!1):10!=h.donation.phone.length||isNaN(h.donation.phone)?(h.phone_invalid=!0,!1):h.donation.email.match(/^[\w\-\+\.]+\@[\w\-\.]+\.[\w]{2,5}$/)?0!=h.donation.amount.length&&isNaN(h.donation.amount)?(h.amount_invalid=!0,!1):(h.phone_absent=!1,h.email_absent=!1,h.phone_invalid=!1,h.email_invalid=!1,h.amount_invalid=!1,!0):(h.email_invalid=!0,!1)},h.addExDonation=function(){if(h.is_processing=!0,c.checkLoggedIn()){var e=c.getUserId();a({method:"POST",url:g.base_url+"donation/add",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{amount:h.donation.amount,donor_name:h.donation.name,donor_email:h.donation.email,donor_phone:h.donation.phone,fundraiser_id:e,created_at:f("date")(h.donation.created_at,"yyyy-MM-dd"),donation_type:h.donation.donation_type,format:"json"}}).success(function(a){h.is_processing=!1;var c=b.alert().title("Success!").content("Donation successfully added. ID: "+a.donation.id).ok("Ok");b.show(c)}).error(function(a){h.is_processing=!1,h.is_error=!0;var c=b.alert().title("Error!").content("Connection issue with '"+add_donation_url+"'. Please try again later.").ok("Ok");b.show(c)})}else{h.is_processing=!1,h.is_error=!0;var i=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(i),d.path("/login")}h.donation={},h.donation.name="",h.donation.amount="",h.donation.email="",h.donation.phone="",h.donation.donation_type="",h.donation.created_at="",h.donationForm.$setUntouched(),h.donationForm.$setPristine()}}]),angular.module("donutApp").controller("AddExternalDonationCtrl",["$http","$mdDialog","UserService","$location","$routeParams","$filter","$rootScope",function(a,b,c,d,e,f,g){var h=this;h.donation={},h.donation.name="",h.donation.amount="",h.donation.email="",h.donation.phone="",h.donation.donation_type="",h.donation.created_at=new Date,h.is_error=!1,h.phone_absent=!1,h.email_absent=!1,h.phone_invalid=!1,h.email_invalid=!1,h.amount_invalid=!1,h.is_processing=!1,h.fundraiser_id=c.getUserId(),h.validCheck=function(){return 0==h.donationForm.$valid?!1:""==h.donation.phone?(h.phone_absent=!0,!1):""==h.donation.email?(h.email_absent=!0,!1):10!=h.donation.phone.length||isNaN(h.donation.phone)?(h.phone_invalid=!0,!1):h.donation.email.match(/^[\w\-\+\.]+\@[\w\-\.]+\.[\w]{2,5}$/)?0!=h.donation.amount.length&&isNaN(h.donation.amount)?(h.amount_invalid=!0,!1):(h.phone_absent=!1,h.email_absent=!1,h.phone_invalid=!1,h.email_invalid=!1,h.amount_invalid=!1,!0):(h.email_invalid=!0,!1)},h.addExDonation=function(){if(h.is_processing=!0,c.checkLoggedIn()){var e=c.getUserId();a({method:"POST",url:g.base_url+"donation/add",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:{amount:h.donation.amount,donor_name:h.donation.name,donor_email:h.donation.email,donor_phone:h.donation.phone,fundraiser_id:e,created_at:f("date")(h.donation.created_at,"yyyy-MM-dd"),donation_type:h.donation.donation_type,format:"json"}}).success(function(a){h.is_processing=!1;var c=b.alert().title("Success!").content("Donation successfully added. ID: "+a.donation.id).ok("Ok");b.show(c)}).error(function(a){h.is_processing=!1,h.is_error=!0;var c=b.alert().title("Error!").content("Connection issue with '"+add_donation_url+"'. Please try again later.").ok("Ok");b.show(c)})}else{h.is_processing=!1,h.is_error=!0;var i=b.alert().title("Error!").content("Connection error. Please try again later.").ok("Ok");b.show(i),d.path("/login")}h.donation={},h.donation.name="",h.donation.amount="",h.donation.email="",h.donation.phone="",h.donation.donation_type="",h.donation.created_at="",h.donationForm.$setUntouched(),h.donationForm.$setPristine()}}]);